<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Diary</title>
  <link rel="stylesheet" href="../css/list.css" />
</head>
<body>
  <div id="list">
    <div class="btn-wrap">
      <a href="#" data-page="../form/diary_form.html" class="button">ê¸€ì“°ê¸°âœï¸</a>
    </div>
    <h2>ğŸ“… ë‹¤ì´ì–´ë¦¬ ë‹¬ë ¥</h2>
    <div id="calendar"></div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const calendar = document.getElementById("calendar");

      const today = new Date();
      const year = today.getFullYear();
      const month = today.getMonth(); // 0-based
      const date = new Date(year, month + 1, 0);
      const daysInMonth = date.getDate();

      let html = '<table class="calendar"><thead><tr>';
      const dayNames = ["ì¼", "ì›”", "í™”", "ìˆ˜", "ëª©", "ê¸ˆ", "í† "];
      for (const day of dayNames) {
        html += `<th>${day}</th>`;
      }
      html += '</tr></thead><tbody><tr>';

      const firstDay = new Date(year, month, 1).getDay();

      // ë¹ˆì¹¸ ì±„ìš°ê¸°
      for (let i = 0; i < firstDay; i++) {
        html += "<td></td>";
      }

      for (let d = 1; d <= daysInMonth; d++) {
        const dayOfWeek = (firstDay + d - 1) % 7;
        const dateStr = `${year}-${(month + 1).toString().padStart(2, "0")}-${d.toString().padStart(2, "0")}`;

        html += `<td class="day" data-date="${dateStr}">${d}<div class="emoji"></div></td>`;

        if (dayOfWeek === 6 && d !== daysInMonth) {
          html += "</tr><tr>";
        }
      }

      html += "</tr></tbody></table>";
      calendar.innerHTML = html;

      // ì˜ˆì‹œ: ì´ëª¨í‹°ì½˜ í‘œì‹œ (ë‚˜ì¤‘ì—” ì„œë²„ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì™€ì„œ ì¶”ê°€ ê°€ëŠ¥)
      const diaryData = {
        "2025-05-10": "ğŸ˜Š",
        "2025-05-13": "ğŸ˜¢",
        "2025-05-15": "ğŸ˜ ",
      };

      for (const [date, emoji] of Object.entries(diaryData)) {
        const cell = document.querySelector(`.day[data-date="${date}"] .emoji`);
        if (cell) {
          cell.textContent = emoji;
          cell.classList.add("clickable");
        }
      }

      // í´ë¦­ ì‹œ ìƒì„¸í˜ì´ì§€ë¡œ ì´ë™
      document.querySelectorAll(".emoji.clickable").forEach((el) => {
        el.addEventListener("click", (e) => {
          const date = el.parentElement.parentElement.getAttribute("data-date");
          const url = `../detail/diary_detail.html?date=${date}`;
          loadPage(url); 
        });
      });
    });

    function loadPage(url) {
      fetch(url)
        .then((res) => res.text())
        .then((data) => {
          document.getElementById("content").innerHTML = data;
        })
        .catch((err) => {
          document.getElementById("content").innerHTML = "<p>í˜ì´ì§€ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>";
          console.error("ì˜¤ë¥˜:", err);
        });
    }
  </script>
</body>
</html>
